import Content from "../../content";
import Code from "../../code";
import solidReactDemoCode from "./index.tsx?raw";
import CodeStep from "../../code/step";

<Content>
    <h2 className="subtitle">Code</h2>

    This demo requires you to authenticate with a Solid account.
</Content>

<Code language="tsx" id="LDOSolidDemo" code={solidReactDemoCode} className="line-numbers">
    <CodeStep lines={["10-11"]} title="Loading resource and retrieving profile">
        `useResource` and `useSubject` are a couple of handy hooks from
        [@ldo/solid-react](https://github.com/o-development/ldobjects/tree/main/packages/solid-react) that
        allow us to 1) fetch the WebID resource, and 2) retrieve it packaged as a `SolidProfile`. This is
        another example of the ease LDO allow you to express your code.

        We set `reloadOnMount` to make sure that LDO always reloads the online resource when the demo is
        shown. I have to do this since the demos don't tell LDO that the online resource has been updated.
    </CodeStep>
    <CodeStep lines={["12", "19", "24", "27-28"]} title="Error handling">
        In this demo there's a couple of things that can go wrong. The first is that something might go wrong when
        retrieving the data (which is shown on line 26), the second is when committing the data back to the online
        resource. If there's any error we pass it on the `Demo` component.
    </CodeStep>
    <CodeStep lines={["14-16"]} title="Loading state">
        While we wait for the resource to be fetched we show the `Loading` component. The test-statements could
        probably be improved, but I think it's expressive enough.
    </CodeStep>
    <CodeStep lines={["20-24"]} title="Updating resource">
        Using `changeData` and `commitData` we tell LDO to handle the underlying updates in the graph and make a
        fetch request to update the online resource.
    </CodeStep>
</Code>

<Content>
    I cannot overemphasize how much I enjoy working with Solid resources using LDO in code like this. It's also the
    smallest demo I've written, and I'm very happy with the readability of it all. For me, this simple fact outweighs
    the cost of setting up, and if anything it encourages me to think more about reusing vocabularies instead of having
    to define my own.
</Content>