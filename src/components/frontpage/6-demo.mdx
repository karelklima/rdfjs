import Content from "../content";
import FrontpageDemo from "./demo";
import Code from "../code";
import demoCode from "../demo/index.tsx?raw"
import CodeStep from "../code/step";
import AuthorNote from "../author-note";
import Install from "../install";
import {NavLink} from "react-router-dom";

<Content id="demo">
    <h2 className="subtitle is-3">How does the demo work?</h2>

    All of the demos use the same component, the `Demo` component. It takes two properties, `name` and `onSubmit`. The
    component presents a form with one simple text input, which presents the name. The form can be submitted, at which
    point the function `onSubmit` will be called.

    If you want to use the code examples in your own code, there are some dependencies that you should install:
</Content>

<Install name="react @ldo/solid-react react-hook-form use-local-storage bulma clsx"/>

<Content>
    Also, you should check out the <NavLink to="/react">guide on React</NavLink> if you want to know more about setting
    this website up yourself.
</Content>

<Content>
    The demo below will not store anything, so refreshing the webpage will reset all changes.
</Content>

<FrontpageDemo/>

<Content>
    This code is written in [TSX](https://www.typescriptlang.org/docs/handbook/jsx.html), a language that combines
    Typescript and ESM files. It's specifically written with React in mind, and relies a lot on [React
    Hooks](https://react.dev/reference/react). That said, I think the overall abstractions are clear, and I'll walk you
    through the various parts:
</Content>

<Code id="FrontpageDemoCode" language="tsx" code={demoCode} className="line-numbers">
    <CodeStep lines={["8-12", "18", "28", "33", "40"]} title="Relaying error, name and onSubmit">
        We pass the data submitted to the parent demo code through `onSubmit`, which provide the specific logic that
        should be done when form is submitted.

        The important part of all of this is that `name` is actually handled in the parent element. In the case that it
        turns out to be an empty string we show an error message, as it's an unexpected value.

        We also relay errors that might arise in the various demos. Although there are cases where an error cannot be
        resolved using this demo, there is a lot of resilience if handled correctly it should be able to fix the RDF
        graph by submitting a name.
    </CodeStep>
    <CodeStep lines={["14-16", "19-24", "28", "39", "44", "46"]} title="Form handling">
        I'm making use of [React Hook Form](https://www.react-hook-form.com/)'s `useForm` to handle form states.
        The `FormData` interface only has one attribute: name. This hook provides us with functionality that
        manages the data flow of the form element at line 33. Also note `useEffect` at line 27, that updates the
        value of name in the form if name is updated elsewhere.

        We also make sure that users don't submit empty strings by showing them an error if they try.
    </CodeStep>
    <CodeStep lines={["25", "35"]} title="Notifications">
        Whenever the name successfully submits, we want to notify the user.
    </CodeStep>
    <CodeStep lines={["26", "31-32", "34", "49"]} title="Throttling submits">
        Whenever we're working with asynchronous functionality when submitting, there might be a delay when
        where things are being updated. Given this behavior, I want to limit when a user can submit updates so that they
        cannot spam the submit-button.
    </CodeStep>
</Code>

<AuthorNote title="On error handling">
    **Error handling is hard!** One thing is the technical aspect, but another is how to convey errors outside of your
    control (and mitigate those within). So I'm not going to claim that how I handle the errors in the demos are a good
    way of doing it. It's really something you have to figure out for your app. But know that there are many errors that
    can happen that are outside of your control, and a good library helps you mitigate those errors in a way that
    doesn't make your code into an entangled mess.
</AuthorNote>