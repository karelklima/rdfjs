import Content from "../../content";
import Code from "../../code";
import solidDemoCode from "./index.tsx?raw";
import useSolidDataset from "./useSolidDataset.ts?raw";
import solidAlternativeDemo from "./demo.alternative.tsx?raw";
import CodeLink from "../../code-link";
import CodeStep from "../../code/step";

<Content>
    This demo requires you to authenticate with a Solid account.
</Content>

<Code language="tsx" id="InruptSolidDemo" code={solidDemoCode} className="line-numbers">
    <CodeStep lines={["14-15"]} title="Setting up dataset and session">
        Like with the local demo we set up the `SolidDataset`, but this time we make use of `useSolidAuth` to
        retrieve data about the WebID.
    </CodeStep>
    <CodeStep lines={["16-18"]} title="Getting profile and name">
        This part is also similar to the local part, but since there are some more moving parts with the actual
        fetching of online resources we need to put in some more safeguards.
    </CodeStep>
    <CodeStep lines={["19", "25", "33", "37", "41"]} title="Error handling">
        There are a couple of things that can go wrong when we interact with a RDF resource in a Solid Pod. First,
        something can go wrong when fetching and parsing the turtle text. Second, something can go wrong when we try
        to update the online resource. If there's any error we pass it on the `Demo` component.
    </CodeStep>
    <CodeStep lines={["22-24"]} title="Fetching resource and parsing dataset">
        Using `getSolidDataset` we have an easy, asynchronous function to get the dataset.
    </CodeStep>
    <CodeStep lines={["28-30"]} title="Loading state">
        Again, similar approach like the local demo.
    </CodeStep>
    <CodeStep lines={["34-38"]} title="Updating online resources upon submit">
        Once we submit a name we make sure to update the profile with the updated name, then update the dataset
        with the updated profile, and making a request using `saveSolidDatasetAt` to save the changes to the
        online resource. We then update our local copy of the dataset to make sure all is updated.
    </CodeStep>
</Code>

<Content>
    <h3>Alternative code: `useSolidDataset`</h3>

    To be fair to Inrupt's library, <CodeLink id="InruptSolidDemo" lines={["14-15", "25-28", "37-38"]}>a lot of this
    code</CodeLink> can be refactored into the hook `useSolidDataset`:
</Content>

<Code id="UseSolidDataset" language="typescript" code={useSolidDataset} className="line-numbers"/>

<Content>
    This way we get a simplified, alternative code for our demo:
</Content>

<Code id="SolidAlternativeDemo" language="tsx" code={solidAlternativeDemo} className="line-numbers"/>
