import Content from "../../content";
import Code from "../../code";
import demoCode from "./index.tsx?raw";
import CodeStep from "../../code/step";

<Content>
    This demo loads and saves a given name locally (in
    [IndexedDB](https://developer.mozilla.org/en-US/docs/Web/API/IndexedDB_API)). If no name is retrieved locally, it
    will use a pre-set name "Test".
</Content>

<Code language="tsx" id="QuadstoreLocalDemo" code={demoCode} className="line-numbers">
    <CodeStep lines={["11-15"]} title="Setting up backend and store">
        I use [BrowserLevel](https://github.com/Level/browser-level) to handle persistent storage in the browser. I'm
        also using [DataFactory from N3.js](https://github.com/rdfjs/N3.js/), but you could use
        [rdf-data-factory](https://www.npmjs.com/package/rdf-data-factory) (or other libraries built on [the RDF/JS Data
        Model specification](https://rdf.js.org/data-model-spec/)) if you prefer.
    </CodeStep>
    <CodeStep lines={["16", "21-25"]} title="Getting name from storage">
        I want to retrieve name from storage if possible, which is done after opening the store with `store.open`. If no
        name is found I set the name to "Test" by default.
    </CodeStep>
    <CodeStep lines={["17", "26", "34", "38"]} title="Error handling">
        I keep track of any errors that might occur and pass them to the `Demo` component.
    </CodeStep>
    <CodeStep lines={["29-31"]} title="Loading state">
        It can take some time to get everything ready, so while we wait I show the `Loading` component.
    </CodeStep>
    <CodeStep lines={["33-40"]} title="Update RDF graph and make it persistent">
        When the user submits the form I use `store.multiPatch` to replace the name in the underlying RDF graph.
        Quadstore handles the persistent storage using BrowserLevel.
    </CodeStep>
</Code>